{
  "version": 3,
  "sources": ["../three/examples/jsm/controls/DragControls.js"],
  "sourcesContent": ["import {\n\tEventDispatcher,\n\tMatrix4,\n\tPlane,\n\tRaycaster,\n\tVector2,\n\tVector3\n} from 'three';\n\nconst _plane = new Plane();\nconst _raycaster = new Raycaster();\n\nconst _pointer = new Vector2();\nconst _offset = new Vector3();\nconst _intersection = new Vector3();\nconst _worldPosition = new Vector3();\nconst _inverseMatrix = new Matrix4();\n\nclass DragControls extends EventDispatcher {\n\n\tconstructor( _objects, _camera, _domElement ) {\n\n\t\tsuper();\n\n\t\t_domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t\tlet _selected = null, _hovered = null;\n\n\t\tconst _intersections = [];\n\n\t\t//\n\n\t\tconst scope = this;\n\n\t\tfunction activate() {\n\n\t\t\t_domElement.addEventListener( 'pointermove', onPointerMove );\n\t\t\t_domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\t\t_domElement.addEventListener( 'pointerup', onPointerCancel );\n\t\t\t_domElement.addEventListener( 'pointerleave', onPointerCancel );\n\n\t\t}\n\n\t\tfunction deactivate() {\n\n\t\t\t_domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t\t_domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\t_domElement.removeEventListener( 'pointerup', onPointerCancel );\n\t\t\t_domElement.removeEventListener( 'pointerleave', onPointerCancel );\n\n\t\t\t_domElement.style.cursor = '';\n\n\t\t}\n\n\t\tfunction dispose() {\n\n\t\t\tdeactivate();\n\n\t\t}\n\n\t\tfunction getObjects() {\n\n\t\t\treturn _objects;\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tupdatePointer( event );\n\n\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\n\t\t\tif ( _selected ) {\n\n\t\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t\t_selected.position.copy( _intersection.sub( _offset ).applyMatrix4( _inverseMatrix ) );\n\n\t\t\t\t}\n\n\t\t\t\tscope.dispatchEvent( { type: 'drag', object: _selected } );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// hover support\n\n\t\t\tif ( event.pointerType === 'mouse' || event.pointerType === 'pen' ) {\n\n\t\t\t\t_intersections.length = 0;\n\n\t\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\t\t\t\t_raycaster.intersectObjects( _objects, true, _intersections );\n\n\t\t\t\tif ( _intersections.length > 0 ) {\n\n\t\t\t\t\tconst object = _intersections[ 0 ].object;\n\n\t\t\t\t\t_plane.setFromNormalAndCoplanarPoint( _camera.getWorldDirection( _plane.normal ), _worldPosition.setFromMatrixPosition( object.matrixWorld ) );\n\n\t\t\t\t\tif ( _hovered !== object && _hovered !== null ) {\n\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveroff', object: _hovered } );\n\n\t\t\t\t\t\t_domElement.style.cursor = 'auto';\n\t\t\t\t\t\t_hovered = null;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( _hovered !== object ) {\n\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveron', object: object } );\n\n\t\t\t\t\t\t_domElement.style.cursor = 'pointer';\n\t\t\t\t\t\t_hovered = object;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( _hovered !== null ) {\n\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveroff', object: _hovered } );\n\n\t\t\t\t\t\t_domElement.style.cursor = 'auto';\n\t\t\t\t\t\t_hovered = null;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tupdatePointer( event );\n\n\t\t\t_intersections.length = 0;\n\n\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\t\t\t_raycaster.intersectObjects( _objects, true, _intersections );\n\n\t\t\tif ( _intersections.length > 0 ) {\n\n\t\t\t\t_selected = ( scope.transformGroup === true ) ? _objects[ 0 ] : _intersections[ 0 ].object;\n\n\t\t\t\t_plane.setFromNormalAndCoplanarPoint( _camera.getWorldDirection( _plane.normal ), _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t\t_inverseMatrix.copy( _selected.parent.matrixWorld ).invert();\n\t\t\t\t\t_offset.copy( _intersection ).sub( _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\t\t}\n\n\t\t\t\t_domElement.style.cursor = 'move';\n\n\t\t\t\tscope.dispatchEvent( { type: 'dragstart', object: _selected } );\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tfunction onPointerCancel() {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( _selected ) {\n\n\t\t\t\tscope.dispatchEvent( { type: 'dragend', object: _selected } );\n\n\t\t\t\t_selected = null;\n\n\t\t\t}\n\n\t\t\t_domElement.style.cursor = _hovered ? 'pointer' : 'auto';\n\n\t\t}\n\n\t\tfunction updatePointer( event ) {\n\n\t\t\tconst rect = _domElement.getBoundingClientRect();\n\n\t\t\t_pointer.x = ( event.clientX - rect.left ) / rect.width * 2 - 1;\n\t\t\t_pointer.y = - ( event.clientY - rect.top ) / rect.height * 2 + 1;\n\n\t\t}\n\n\t\tactivate();\n\n\t\t// API\n\n\t\tthis.enabled = true;\n\t\tthis.transformGroup = false;\n\n\t\tthis.activate = activate;\n\t\tthis.deactivate = deactivate;\n\t\tthis.dispose = dispose;\n\t\tthis.getObjects = getObjects;\n\n\t}\n\n}\n\nexport { DragControls };\n"],
  "mappings": "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",
  "names": []
}
